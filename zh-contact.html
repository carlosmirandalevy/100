<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>&#32852;&#31995;&#25105;&#20204; | 100&#20010;AI&#23454;&#29992;&#26696;&#20363; | CEMI.AI</title>
    <meta name="description" content="&#32852;&#31995;CEMI.AI&#12290;&#30003;&#35831;&#20010;&#24615;&#21270;AI&#23398;&#20064;&#35838;&#31243;&#12289;&#21672;&#35810;&#35780;&#20272;&#12289;&#21512;&#20316;&#20249;&#20276;&#25110;&#21457;&#36865;&#24120;&#35268;&#21672;&#35810;&#12290;">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://100.cemi.ai/assets/images/100-ai-og.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://100.cemi.ai/assets/images/100-ai-og.png">
    <script src="include.js"></script>
</head>
<body data-page="contact">

<!-- Hero -->
<section class="page-hero">
    <div class="hero-orb hero-orb-1" style="width:300px;height:300px"></div>
    <div class="hero-orb hero-orb-2" style="width:250px;height:250px"></div>
    <div class="page-hero-content">
        <h1><span class="gradient-text">&#32852;&#31995;&#25105;&#20204;</span></h1>
        <p style="font-size:1.1rem;max-width:550px;margin:var(--space-md) auto 0">&#26377;&#38382;&#39064;&#12289;&#24819;&#30003;&#35831;&#23398;&#20064;&#35838;&#31243;&#25110;&#25506;&#35752;&#21512;&#20316;&#65311;&#25105;&#20204;&#26399;&#24453;&#24744;&#30340;&#26469;&#20449;&#12290;</p>
    </div>
</section>

<!-- Contact Form -->
<section class="section">
    <div class="container" style="max-width:700px">

        <form id="contact-form" class="contact-form reveal" novalidate>
            <!-- Honeypot -->
            <div style="position:absolute;left:-9999px;top:-9999px" aria-hidden="true">
                <input type="text" name="website" tabindex="-1" autocomplete="off">
            </div>

            <div class="contact-field">
                <label for="cf-name">&#22995;&#21517; <span class="contact-required">*</span></label>
                <input type="text" id="cf-name" maxlength="200" required placeholder="&#24744;&#30340;&#20840;&#21517;" autocomplete="name">
                <div class="contact-error" id="cf-err-name"></div>
            </div>

            <div class="contact-field">
                <label for="cf-email">&#30005;&#23376;&#37038;&#31665; <span class="contact-required">*</span></label>
                <input type="email" id="cf-email" required placeholder="you@example.com" autocomplete="email">
                <div class="contact-error" id="cf-err-email"></div>
            </div>

            <div class="contact-field">
                <label for="cf-org">&#32452;&#32455;&#26426;&#26500; <span style="color:var(--text-secondary);font-weight:400">(&#21487;&#36873;)</span></label>
                <input type="text" id="cf-org" maxlength="200" placeholder="&#20844;&#21496;&#25110;&#26426;&#26500;" autocomplete="organization">
            </div>

            <div class="contact-field">
                <label for="cf-subject">&#20027;&#39064; <span class="contact-required">*</span></label>
                <select id="cf-subject" required>
                    <option value="">&#8212; &#36873;&#25321;&#19968;&#20010;&#20027;&#39064; &#8212;</option>
                    <option value="program">&#23398;&#20064;&#35838;&#31243;&#30003;&#35831;</option>
                    <option value="assessment">AI&#23601;&#32490;&#35780;&#20272;</option>
                    <option value="consulting">&#21672;&#35810;&#26381;&#21153;</option>
                    <option value="products">AI&#20135;&#21697;</option>
                    <option value="partnership">&#21512;&#20316;&#21672;&#35810;</option>
                    <option value="suggest">&#20869;&#23481;&#24314;&#35758;</option>
                    <option value="general">&#24120;&#35268;&#38382;&#39064;</option>
                </select>
                <div class="contact-error" id="cf-err-subject"></div>
            </div>

            <div class="contact-field">
                <label for="cf-message">&#30041;&#35328; <span class="contact-required">*</span></label>
                <textarea id="cf-message" rows="6" maxlength="3000" required placeholder="&#35831;&#21578;&#35785;&#25105;&#20204;&#24744;&#30340;&#38656;&#27714;&hellip;"></textarea>
                <div class="contact-char-count" id="cf-cc-message"></div>
                <div class="contact-error" id="cf-err-message"></div>
            </div>

            <div class="contact-field">
                <button type="submit" class="btn btn-primary" id="cf-submit" style="width:100%">&#21457;&#36865;&#28040;&#24687;</button>
                <div class="contact-error contact-error-general" id="cf-err-general"></div>
            </div>
        </form>

        <!-- Success State -->
        <div class="contact-success reveal" id="contact-success" style="display:none">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="var(--accent-4)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
            <h2 class="gradient-text" style="margin:var(--space-md) 0 var(--space-sm)">&#35874;&#35874;&#24744;&#65281;</h2>
            <p style="color:var(--text-secondary);margin-bottom:var(--space-lg)">&#24744;&#30340;&#28040;&#24687;&#24050;&#21457;&#36865;&#12290;&#25105;&#20204;&#20250;&#23613;&#24555;&#22238;&#22797;&#24744;&#12290;</p>
            <button class="btn btn-outline" id="cf-another">&#20877;&#21457;&#19968;&#26465;&#28040;&#24687;</button>
        </div>

        <!-- Quick Links -->
        <div class="reveal" style="margin-top:var(--space-2xl);text-align:center">
            <p style="color:var(--text-secondary);margin-bottom:var(--space-md)">&#22312;&#25214;&#29305;&#23450;&#20869;&#23481;&#65311;</p>
            <div style="display:flex;gap:var(--space-md);justify-content:center;flex-wrap:wrap">
                <a href="zh-program.html" class="btn btn-outline" style="font-size:0.9rem">&#23398;&#20064;&#35838;&#31243;</a>
                <a href="zh-ai-readiness.html" class="btn btn-outline" style="font-size:0.9rem">AI&#23601;&#32490;&#35780;&#20272;</a>
                <a href="zh-about.html" class="btn btn-outline" style="font-size:0.9rem">&#20851;&#20110;&#25105;&#20204;</a>
            </div>
        </div>

    </div>
</section>

<script>
(function() {
    'use strict';

    var COOLDOWN_MS = 30000;
    var lastSubmitTime = 0;
    var lang = document.documentElement.lang || 'en';

    var form = document.getElementById('contact-form');
    var submitBtn = document.getElementById('cf-submit');
    var successEl = document.getElementById('contact-success');

    // Pre-fill subject from URL param (e.g., ?subject=program)
    var urlParams = new URLSearchParams(window.location.search);
    var preSubject = urlParams.get('subject');
    if (preSubject) {
        var subjectSelect = document.getElementById('cf-subject');
        if (subjectSelect.querySelector('option[value="' + preSubject + '"]')) {
            subjectSelect.value = preSubject;
        }
    }

    // Character counter for message
    var msgInput = document.getElementById('cf-message');
    var msgCounter = document.getElementById('cf-cc-message');
    if (msgInput && msgCounter) {
        msgInput.addEventListener('input', function() {
            var remaining = 3000 - msgInput.value.length;
            msgCounter.textContent = remaining + ' \u4e2a\u5b57\u7b26\u5269\u4f59';
            msgCounter.classList.toggle('warn', remaining < 100);
        });
    }

    function clearErrors() {
        form.querySelectorAll('.contact-error').forEach(function(el) { el.textContent = ''; });
        form.querySelectorAll('.contact-field').forEach(function(el) { el.classList.remove('has-error'); });
    }

    function showError(field, msg) {
        var errEl = document.getElementById('cf-err-' + field);
        if (errEl) errEl.textContent = msg;
        var parent = errEl && errEl.closest('.contact-field');
        if (parent) parent.classList.add('has-error');
    }

    function validate() {
        clearErrors();
        var valid = true;

        var name = document.getElementById('cf-name').value.trim();
        if (!name) { showError('name', '\u8bf7\u8f93\u5165\u60a8\u7684\u59d3\u540d\u3002'); valid = false; }
        else if (name.length > 200) { showError('name', '\u6700\u591a200\u4e2a\u5b57\u7b26\u3002'); valid = false; }

        var email = document.getElementById('cf-email').value.trim();
        if (!email) { showError('email', '\u8bf7\u8f93\u5165\u60a8\u7684\u7535\u5b50\u90ae\u7bb1\u3002'); valid = false; }
        else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { showError('email', '\u8bf7\u8f93\u5165\u6709\u6548\u7684\u7535\u5b50\u90ae\u7bb1\u3002'); valid = false; }

        var subject = document.getElementById('cf-subject').value;
        if (!subject) { showError('subject', '\u8bf7\u9009\u62e9\u4e00\u4e2a\u4e3b\u9898\u3002'); valid = false; }

        var message = document.getElementById('cf-message').value.trim();
        if (!message) { showError('message', '\u8bf7\u8f93\u5165\u60a8\u7684\u7559\u8a00\u3002'); valid = false; }
        else if (message.length > 3000) { showError('message', '\u6700\u591a3000\u4e2a\u5b57\u7b26\u3002'); valid = false; }

        return valid;
    }

    // Load Firebase on demand
    var firebaseLoading = false;
    var firebaseReady = false;

    function loadFirebase(callback) {
        if (window.__db) { callback(); return; }
        if (firebaseLoading) {
            var check = setInterval(function() {
                if (window.__db) { clearInterval(check); callback(); }
            }, 100);
            return;
        }
        firebaseLoading = true;
        var fbBase = 'https://www.gstatic.com/firebasejs/10.14.1/';
        var queue = [fbBase + 'firebase-app-compat.js', fbBase + 'firebase-firestore-compat.js', 'firebase-config.js'];
        (function loadNext(i) {
            if (i >= queue.length) { firebaseReady = true; callback(); return; }
            var s = document.createElement('script');
            s.src = queue[i];
            s.onload = function() { loadNext(i + 1); };
            s.onerror = function() {
                showError('general', '\u65e0\u6cd5\u8fde\u63a5\u3002\u8bf7\u91cd\u8bd5\u3002');
                submitBtn.disabled = false;
                submitBtn.textContent = '\u53d1\u9001\u6d88\u606f';
            };
            document.body.appendChild(s);
        })(0);
    }

    form.addEventListener('submit', function(e) {
        e.preventDefault();
        if (!validate()) return;

        // Rate limiting
        var now = Date.now();
        if (now - lastSubmitTime < COOLDOWN_MS) {
            showError('general', '\u8bf7\u7a0d\u7b49\u540e\u518d\u53d1\u9001\u3002');
            return;
        }

        // Honeypot
        var honeypot = form.querySelector('input[name="website"]');
        if (honeypot && honeypot.value) return;

        submitBtn.disabled = true;
        submitBtn.textContent = '\u53d1\u9001\u4e2d\u2026';

        loadFirebase(function() {
            if (!window.__db) {
                showError('general', '\u51fa\u4e86\u70b9\u95ee\u9898\u3002\u8bf7\u91cd\u8bd5\u3002');
                submitBtn.disabled = false;
                submitBtn.textContent = '\u53d1\u9001\u6d88\u606f';
                return;
            }

            var data = {
                name: document.getElementById('cf-name').value.trim(),
                email: document.getElementById('cf-email').value.trim(),
                organization: document.getElementById('cf-org').value.trim(),
                subject: document.getElementById('cf-subject').value,
                message: document.getElementById('cf-message').value.trim(),
                language: lang,
                page: document.body.dataset.page,
                status: 'new',
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            };

            window.__db.collection('contacts').add(data).then(function() {
                if (typeof gtag === 'function') gtag('event', 'contact_submit', { subject: data.subject, language: data.language });
                lastSubmitTime = Date.now();
                form.style.display = 'none';
                successEl.style.display = '';
                submitBtn.disabled = false;
                submitBtn.textContent = '\u53d1\u9001\u6d88\u606f';
            }).catch(function() {
                showError('general', '\u51fa\u4e86\u70b9\u95ee\u9898\u3002\u8bf7\u91cd\u8bd5\u3002');
                submitBtn.disabled = false;
                submitBtn.textContent = '\u53d1\u9001\u6d88\u606f';
            });
        });
    });

    // "Send Another" button
    document.getElementById('cf-another').addEventListener('click', function() {
        successEl.style.display = 'none';
        form.style.display = '';
        form.reset();
        clearErrors();
    });
})();
</script>

</body>
</html>
